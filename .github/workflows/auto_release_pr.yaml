name: Release with commit

on:
  push:
    tags:
      - "v[0-9]+.[0-9]+.[0-9]"
      - "v[0-9]+.[0-9]+.[0-9]+-beta"
      - "v[0-9]+.[0-9]+.[0-9]+-alpha"
      - "v[0-9]+.[0-9]+.[0-9]+-rc"

jobs:
  release-pipeline:
    runs-on: ubuntu-latest
    # if: github.ref == 'refs/heads/main'
    steps:
      - name: Checkout
        uses: actions/checkout@v2
      # "Build" the files
      - name: prepare files to be compresses
        run: mkdir -p toCompress/dist; cp test_file_1.txt toCompress; cp test_file_3.txt toCompress; cp foo/bar/*.ts toCompress/dist
      # tar the files
      - name: tar the files
        uses: a7ul/tar-action@v1.1.0
        id: compress
        with:
          command: c
          files: |
            ./toCompress
          outPath: ${{ github.ref_name }}.tar.gz
      # create a release with the tar as a file
      - name: Release
        uses: softprops/action-gh-release@v1
        with:
          files: ${{ github.ref_name }}.tar.gz